<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!-- last modified on 23.05.2004 -->
<html>
<head>
<title>
DOIT_ST - Tips u. Tricks zur Atari Serie: Keyboard
</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Generator" content="UDO6 PL14 for TOS">
<meta name="Email" content="doit@doitarchive.de">
<link rev=made href="mailto:doit@doitarchive.de" title="E-Mail">
<link rel=home href="doitst1h.htm" title="Homepage">
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF0000" vlink="#800080">

<table border=0 cellpadding=0 cellspacing=0 width="100%"><tr><td valign=top>
<a href="00con.htm" target="UDOcon"><img src="udo_hm.gif" alt="Home" border=0 width="24" height="24"></a>
<a href="0f.htm" target="UDOcon"><img src="udo_up.gif" alt="Schnittstellen" border=0 width="24" height="24"></a>
<a href="0f.htm" target="UDOcon"><img src="udo_lf.gif" alt="Schnittstellen" border=0 width="24" height="24"></a>
<a href="0f0101.htm" target="UDOcon"><img src="udo_rg.gif" alt="How to connect a STe-Keyboard" border=0 width="24" height="24"></a>
</td></tr></table>
<table border=0 cellpadding=0 cellspacing=0 width="100%"><tr>
<td valign=top width="8">&nbsp;</td><td valign=top width="100%">
<h1><a name="Keyboard">15.1 Keyboard</a></h1>
<p align=center><img src="image/sline.gif" border=0 width="640" height="2"></p><br>
<p><tt> Die Tastatur am Atari </tt>
<br>
<br>
</p>
<p><img src="image/deutsch.gif" border=0 width="35" height="22"></p><br>
<p><img src="image/english.gif" border=0 width="35" height="22"></p><br>
<p>Interessant f&uuml;r jeden der mit dem Gedanken spielt seinen
Atari mit allem Zubeh&ouml;r in ein Towergeh&auml;use zu verfrachten.
Speziell daf&uuml;r kann man die Keyboards von einem MegaST oder von
TT verwenden. Diese Keyboards gibt es teilweise bei den H&auml;ndlern
f&uuml;r sehr wenig Geld.
<br>
</p>
<p>Man spart sich so den Umweg &uuml;ber die diversen PC-Keyboards
die allesamt wieder ein Interface ben&ouml;tigen und in den wenigsten
F&auml;llen korrekt beschriftet sind. Jedenfalls bei den
Funktionstasten ect.
<br>
</p>
<p>Da ich schon vor Jahren einen ST im Tower hatte ist es also kein
Problem die hier gewonnen Erkenntnisse auch bei jeden anderen Atari
anzuwenden, diesen Rechner mit einer abgesetzten Tastatur zu versehen
sollte also auch nicht sehr Problematisch werden. Zumal hier vom alten
ST-Tower und dessen Keyboard das Geh&auml;use mit samt der passenden
Treiberschaltung &uuml;brig ist. Alle Atari-Keyboards &uuml;bertragen
die Signale seriell.
<br>
</p>
<p>Im Atari gibt es zum Anschlie&szlig;en der Tastatur meistens eine
10 polige Pfostenleiste die mit der im 1040 ST/e und der im Falcon
identisch ist. Hier untenstehend also gleich die Pinbelegung der
Pfostenleiste im <a href="0305.htm" target="UDOcon">Atari ST</a>. Etwas weiter unten folgt die
Steckerbelegung der Mega oder TT-Tastatur. Man kann so schon sofort
sehen welche Verbindungen herzustellen sind. Sie sind nach dem Studium
dieses Artikels in der Lage jede Atari Tastatur an jeden Atari
Computer anschliessen zu k&ouml;nnen.
<br>
<br>
<br>
</p>
<p>
<br>
<br>
</p>
<p align=center><img src="image/keyb2.gif" border=0 width="500" height="139"></p><br>
<div align=center><tt> Abbildung 1 - Original Atari Keyboard von innen </tt>
<br>
</div>
<p>
<br>
<br>
</p>
<p><b> Keyboard-Pfostenleiste J12 im <a href="0305.htm" target="UDOcon">Atari ST</a>:</b>
<br>
</p>
<p>Anhand dieser Pinbelegung kann man sehr deutlich sehen welche
Signale zum Betrieb einer Tasstatur notwending sind und welche nicht.
Alle Maus- sowie Joystick Signale sind auf anderen Tastaturen nicht
mehr vorhanden. An der Falcon Tastatur sind diese Signale lediglich
von den Anschlu&szlig;buchsen bis zur Anschlu&szlig;stiftleiste
durchverdrahtet.
<br>
</p>
<p>In der Tastaturen mir 4 poligen Anschlu&szlig;kabeln werden diese
Signale von der Tastaturelektronik ausgewertet und dem Mainboard
zugef&uuml;hrt. Bei Atari Computern die ihre Maus- u.
Joystickanschl&uuml;sse direkt am Rechnergeh&auml;use haben hat die
Tastatur mit diesen Signalen nichts zu tun.
<br>
</p>
<p>
<br>
<br>
</p>
<p align=center><img src="image/keyb1.gif" border=0 width="400" height="135"></p><br>
<div align=center><tt> Abbildung 2 - Original Atari Keyboard </tt>
<br>
</div>
<p>
<br>
<br>
</p>
<dl>
<dt><b>Stiftnummer/Signal Beschreibung:</b></dt><dd>
<br>
<br>&nbsp;
<dt><b>Pin 18</b></dt><dd> Nicht benutzt
<br>Not used
<br>&nbsp;
<dt><b>Pin 17</b></dt><dd> Nicht benutzt
<br>Not used
<br>&nbsp;
<dt><b>Pin 16</b></dt><dd> Reset
<br>Reset um den Tastaturprozessor in einen definierten
<br>Ausgangszustand zu versetzen. (Auch <a href="0909.htm" target="UDOcon">PowerOn Reset</a>)
<br>&nbsp;
<dt><b>Pin 15</b></dt><dd> TX Data
<br>Daten werden zum Mainboard gesendet.
<br>&nbsp;
<dt><b>Pin 14</b></dt><dd> RX Data
<br>Daten werden vom Mainboard empfangen.
<br>&nbsp;
<dt><b>Pin 13</b></dt><dd> +5V
<br>Spannungsversorgung f&uuml;r die Tastaturelektronik.
<br>&nbsp;
<dt><b>Pin 12</b></dt><dd> XB / Up
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 11</b></dt><dd> Left Button / Fire
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 10</b></dt><dd> XA / Down
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 9</b></dt><dd> YA / Left
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 8</b></dt><dd> YB / Right
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 7</b></dt><dd> Up
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 6</b></dt><dd> Fire Button
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 5</b></dt><dd> Down
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 4</b></dt><dd> Left
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin 3</b></dt><dd> Right
<br>Joystick und Mausanschlu&szlig;
<br>Beim ST direkt mit dem Mainboard verbunden
<br>
<br>&nbsp;
<dt><b>Pin o</b></dt><dd> Leerfeld, damit der <a href="0f0b.htm" target="UDOcon">Stecker</a> nur in einer Richtung passt
<br>&nbsp;
<dt><b>Pin 1</b></dt><dd> GND oder auch 5V Return
<br>Masse-Signalmasse und Kabelschirm
<br>&nbsp;
</dl>
<p>
<br>
<br>
</p>
<p><b> Mega STE oder TT-Tastatur </b>
<br>
<br>
</p>
<p>Die Belegung des Steckers von oben gesehen, nur f&uuml;r den Fall
das vieleicht jemand auf die Idee kommen sollte seine alte
STE-Tastatur doch eventuell am neuen Falcon-Tower einsetzen zu wollen.
<br>
<br>
<br>
</p>
<p align=center><img src="image/keybstec.gif" border=0 width="170" height="120"></p><br>
<div align=center><tt> Abbildung 3 - Westernstecker am Keyboard </tt>
<br>
</div>
<p>
<br>
<br>
</p>
<p>Sollten beim Anschlu&szlig; eines Keyboards aus welchen
Gr&uuml;nden auch immer die Pin f&uuml;r +5 Volt und GND vertauscht
werden kann der Rechner *irreparabel* Besch&auml;digt werden. Das
Keyboard ist dann sowieso meistens defekt!
<br>
</p>
<p>Hier ist es in jeden Fall sehr sicher ein Ohmmeter zu benutzten.
Auch zwei mal wenn es sein mu&szlig;.
<br>
</p>
<p>Es gibt z.B bei Hard &amp; Soft Geh&auml;use zum Absetzen des
Keyboards. Man kann so die Tastatur direkt da einbauen und wie oben
beschrieben mit der Hauptplatine verbinden. Das Geh&auml;use besitzt
auch eine Treiberschaltung in Form eines 74F07 o.&Auml;.
<br>
</p>
<p>Warscheinlich gibt es hier auch einen Anschlu&szlig; f&uuml;r eine
extra Resettaste.
<br>(War wenigstens fr&uuml;her so)
<br>
</p>
<p>Die Steckerbelegung mu&szlig; nat&uuml;rlich dann noch angepasst
werden. Wer es denn ganz geschickt anstellt baut einfach die Tastatur
seines Ataris in ein externes Tastaturgeh&auml;use und schlie&szlig;t
diese dann &uuml;ber ein Spiralkabel an den Tower an. Womit man auch
eine LED f&uuml;r das <a href="0b04.htm" target="UDOcon">Disketten</a>- und das Festplattenlaufwerk auch
nacht&auml;glich einbauen kann.
<br>
</p>
<p>
<br>
<br><b> Kabell&auml;nge und Treiberschaltung </b>
<br>
</p>
<p>Soll das Tastaturkabel etwas l&auml;nger werden, 2 Meter klappen
der Regel nach gerade noch so, ist ein Hardwaretreiber f&uuml;r die
Leitungen Rx, Tx sowie Reset zwingend erforderlich. Hier wird meine
Treiberschaltung mit einem 74LS07 beschrieben. Sofern nicht bereits
eine Treiberschaltung in dem externen (gekauften) Geh&auml;use
vorhanden ist, sollten sie diese oder eine &auml;hnliche Schaltung
verwenden um einen sichern Betrieb zu erreichen.
<br>
</p>
<p>Tastaturkabel kann man NICHT endlos verl&auml;ngern!
<br>
</p>
<p>Sie sollten beachten das einige Tastaturen eine Resetleitung
haben, andere wiederum nicht. Bestes Beispiel ist die Tastatur vom ST,
die Tastatur von MEGA ST hat keine Resetleitung.
</p>
<p>Der ST musste billig sein, daher hatten die Designer das notwenige
Reset Signal einfach vom Mainboard geholt. Beim Mega ST, kam man auf
die Idee das eine eigene Resetschaltung auf der Tastatur nun der
billigere Weg sei. Daher hat diese Tastatur auch keinen
Anschlu&szlig;pin f&uuml;r eben eine Resetleitung.
<br>
</p>
<p>Offensichtlich war hier damals dann Kabel teuerer
<br>
</p>
<p>Generell ist an jeder Tastatur ein Reset erforderlich, einmal wenn
sie Reset bet&auml;tigen oder eben im Moment des Einschaltens ihres
Ataris. In beiden F&auml;llen mu&szlig; die <a href="080108.htm" target="UDOcon">CPU</a> der Tastatur in einen
definierten Ausgangszustand versetzt werden. Ist das nicht der Fall,
hakelt die Tastatur, einige Tasten werden nicht oder nur sporadisch
erkannt. Dies h&auml;ngt auch direkt mit zu langen
Anschlu&szlig;kabeln zusammen. F&uuml;r Tastaturkabel sollten sie
generell nur abgeschirmte Leitungen verwenden.
<br>
</p>
<p>Einen Reset erzeugt man in dem man den Reset Pin der Tastatur,
&uuml;ber einen 1KOhm-10KOhm Widerstand direkt mit GND verbindet. Da
man aber nicht einen extra Resettaster f&uuml;r eine solche Tastatur
einbauen will gibt es folgende L&ouml;sung:
<br>
</p>
<p>Eine einfache Schaltung, bestehend aus einem Elko mit 100uF/10V
und einer Diode 1N4148, kann dieses Resetproblem schnell und sauber
l&ouml;sen. Den Elko verschaltet man zwischen Reset und GND in Reihe
mit einem Widerstand von 1K-10K, je nach dem, Wert ausprobieren. Die
Diode verhindert das sich der Kondensator entl&auml;d wenn
ausgeschaltet wird.
<br>
</p>
<p>
<br>
<br>
</p>
<p align=center><img src="image/reset1.gif" border=0 width="400" height="91"></p><br>
<div align=center><tt> Abbildung 4 - Resetschaltung f&uuml;r abgesetztes Keyboard
</tt>
<br>
</div>
<p>
<br>
<br>
</p>
<p>Die Resetleitung der Tastatur wird auf solange auf Low gehalten
bis sich der Kondensator &uuml;ber den Widerstand aufgeladen hat. Die
Zeit reicht aller Regel nach um den Tastaturprozessor vorzugaukeln das
ein richtiger Reset erfolgt ist. Rechts im Bild das RC-Glied wie es
von Atari im MegaST verwendet wurde.
<br>
</p>
<p>Wem das zu suspekt erscheint greift etwas tiefer in die Tasche und
kauft sich einen DS1232 von Dallas. Das Teil hat genau drei
Anschlu&szlig;beinchen, beschriftet mit Vcc, GND und Reset und
erledigt genau das gleiche wie meine Schaltung. Ausserdem ist das nur
ein einziges kleines Bauteil.
<br>
</p>
<p>Die Resetschaltung ist nat&uuml;rlich auf der entsprechenden
Tastatur unterzubringen, denn an allen anderen Stellen nutzt sie
nichts und stiftet nur Verwirrung.
<br>
</p>
<p>
<br>
<br>
</p>
<p align=center><img src="image/f030keyb.gif" border=0 width="450" height="345"></p><br>
<div align=center><tt> Abbildung 5 - Treiberschaltung f&uuml;r abgesetztes
Keyboard</tt>
<br>
</div>
<p>
<br>
<br>
</p>
<p>Zu Bemerken w&auml;re noch das es aussreicht wenn RxT, TxT sowie
das Reset-Signal &uuml;ber einen Treiberbausten gef&uuml;hrt werden.
+5 Volt und GND laufen logischerweise ohne Treiber. Die Schaltung
selber, sofern nicht vorhanden, kann auf einer Lochrasterplatine
aufgebaut werden, die Schaltung besteht Quasi aus einem einzigen
Bauteil in Form eines ICs und einigen Pullup-Widerst&auml;nden.
Jedenfalls passt diese Schaltung in jede abgesetzte Tastatur immer
direkt hinter die Anschlu&szlig;buchse.
</p>
<p>Bei Keybords mit festem Anschlu&szlig;kabel ist zu pr&uuml;fen ob
die Aderzahl im Kabel ausreicht auch die Resetleitung
mitzuf&uuml;hren. Sie k&ouml;nnen eine Tastatur MIT Resetleitung
schlecht betreiben ohne diese Leitung mit der Resetschaltung des
Mainboards zu verbinden!
<br>
</p>
<p>Tastaturen OHNE diese Resetleitung k&ouml;nnen hingegen an jedem
Atari betrieben werden. Hier ist der PowerON Reset intern, in einer
ge&auml;nderten Schaltung der Tastatur, geregelt.
<br>
</p>
<p>
<br>
<br>
</p>
<p><b> 260/520/1040ST/F030 (F/FM/E) Keyboards </b>
<br>
</p>
<p>Zum besseren Verst&auml;ndniss hier eine Auflistung aller Pin die
man braucht um eine Mega-Tastatur mit einem <a href="09.htm" target="UDOcon">Atari TOS</a> Computer zu
verbinden. Beachten Sie unbedingt die unterschiedlichen Pinbelegungen
der unterschiedlichen Hauptplatinen!
<br>
</p>
<p>Beachten Sie bitte das die Laufrichtung der Nummern am <a href="0f0b.htm" target="UDOcon">Stecker</a>
einer Mega-Tastatur von unten nach oben verl&auml;uft wenn man den
RJ45 <a href="0f0b.htm" target="UDOcon">Stecker</a> von oben betrachtet, also in der Reihenfolge 1,2 bis 6
<br>
</p>
<p>Mega(ST(e)) Keyboards ben&ouml;tigen nur +5V, GND, RxD und TxD!
<br>
<br>
</p>
<dl>
<dt><b>MegaST - TT - MegaSTe</b></dt><dd> Pin 1 + 2 +5VDC
<br>Pin 3 TxD
<br>Pin 4 RxD
<br>Pin 5 + 6 GND
<br>
<br>&nbsp;
<dt><b>260ST - 520ST</b></dt><dd> Pin 1 GND
<br>Pin 13 +5VDC
<br>Pin 14 RxD
<br>Pin 15 TxD
<br>
<br>&nbsp;
<dt><b>1040STe - all - and Falcon</b></dt><dd> Pin 1 GND
<br>Pin 2 ** KEY
<br>Pin 3 FDD/HDD LED
<br>Pin 4 +5VDC
<br>Pin 5 RxD
<br>Pin 6 TxD
<br>Pin 7 Reset
<br>Pin 8 GND
<br>Pin 9 KTOK
<br>Pin 10 KROK
<br>
<br>&nbsp;
</dl>
<p>
<br>
<br><b> Connect external Keyboards </b>
<br>
<br>
</p>
<p>If you like to connect you MegaST-Keyboard to you 520ST, watch the
schematic:
<br>
</p>
<pre>

                  +--------o 1  GND
                  +        . 2  (Key !!)
                  +        o 3
                  +        o 4
                  +        o 5
       ______     +        o 6
   ----|  6 o-----+        o 7
   |      5 o-----+        o 8
   |      4 o-------+      o 9
   |      3 o-----+ +      o 10
   |      2 o--+  + +      o 11
   ----|  1 o--+------+    o 12
       ------     + + +----o 13  + 5V
     Mega-Cable   + +------o 14  Rx Data, Pin 2 <a href="08010a.htm" target="UDOcon">ACIA</a>
                  +--------o 15  Tx Data, Pin 6 <a href="08010a.htm" target="UDOcon">ACIA</a>)
                           o 16  Reset
                           o 17
                           o 18

                       520ST connector

</pre>
<p>
<br>
</p>
<p>And the procedure again, only as text list:
<br>
</p>
<pre>
     Mega-Keyboard-Cable                   260/520ST Connector
          1 und 2                               13 (+ 5V)
             3                                  15 (TxData)
             4                                  14 (RxData)
          5 und 6                                1 (Masse)

</pre>
<p>
<br>
</p>
<p>That works on some machines, watch out for the right connection!
<br>Wrong connections destroys hardware. Author can't take any
warranty for burned hardware!
<br>
<br>
<br><b> Reset and long wire </b>
<br>
</p>
<p>If ST's keyboard has a RESET line and MEGA ST does not, it means
that designers wanted to shawe off some costs with ST and they have
borrowed RESET signal from the machine itself.
</p>
<p>With Mega ST, they probably decided that having RESET circuit in
keyboard is cheaper that extra wires in the cable. It probably has to
be reset at power-up and left inactive since.
</p>
<p>You can try that. When keyboard &quot;hands&quot; after power-up,
try connecting RESET signal to the GND briefly (with pullup resistor
of several KOhm-anything from 1K to 10 K-usually not critical). If
after that kbd recovers, you have found cause of trouble.
</p>
<p>Now you have to make some kind of circuit to reset kbd at pw-up.
Simplest thing would be to use elko of say 100 mikroF/10V between
RESET and GND and one diode (like 1N4148), pointing from RESET to Vcc.
That way, RESET will stay low after power-up just enough to cause
RESET of the kbd , while elko is filled through pullup resistor.
<br>
</p>
<p>Diode takes care of dischrging elko when everything gets powered
off.
<br>
</p>
<p>If that is not good enough, use something like DS1232 from Dallas.
Thing has3 pins, GND, VCC and RESET, just what you need and doesn't
need extra components.
<br>
</p>
<p>
<br>
<br>
</p>
<p align=center><img src="image/sline.gif" border=0 width="640" height="2"></p><br>
<p align=center><img src="image/img.gif" border=0 width="50" height="40"></p><br>
<ul>
<li>15.1.1 <a href="0f0101.htm" target="UDOcon">How to connect a STe-Keyboard</a></li>
<li>15.1.2 <a href="0f0102.htm" target="UDOcon">PC Keyboard Interface</a></li>
</ul>
<br>

<hr>
<address>Copyright &copy; <a href="http://www.doitarchive.de/">Robert Schaffner</a> (<a href="mailto:doit@doitarchive.de">doit@doitarchive.de</a>)<br>
Letzte Aktualisierung am 23. Mai 2004</address>
</td></tr></table>
<table border=0 cellpadding=0 cellspacing=0 width="100%"><tr><td valign=top>
<a href="00con.htm" target="UDOcon"><img src="udo_hm.gif" alt="Home" border=0 width="24" height="24"></a>
<a href="0f.htm" target="UDOcon"><img src="udo_up.gif" alt="Schnittstellen" border=0 width="24" height="24"></a>
<a href="0f.htm" target="UDOcon"><img src="udo_lf.gif" alt="Schnittstellen" border=0 width="24" height="24"></a>
<a href="0f0101.htm" target="UDOcon"><img src="udo_rg.gif" alt="How to connect a STe-Keyboard" border=0 width="24" height="24"></a>
</td></tr></table>
</body></html>
