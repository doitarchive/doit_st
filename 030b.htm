<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!-- last modified on 23.05.2004 -->
<html>
<head>
<title>
DOIT_ST - Tips u. Tricks zur Atari Serie: MegaST Bus
</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Generator" content="UDO6 PL14 for TOS">
<meta name="Email" content="doit@doitarchive.de">
<link rev=made href="mailto:doit@doitarchive.de" title="E-Mail">
<link rel=home href="doitst1h.htm" title="Homepage">
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF0000" vlink="#800080">

<table border=0 cellpadding=0 cellspacing=0 width="100%"><tr><td valign=top>
<a href="00con.htm" target="UDOcon"><img src="udo_hm.gif" alt="Home" border=0 width="24" height="24"></a>
<a href="03.htm" target="UDOcon"><img src="udo_up.gif" alt="Atari ST Series Hardware" border=0 width="24" height="24"></a>
<a href="030a.htm" target="UDOcon"><img src="udo_lf.gif" alt="Spezifikation Mega STe" border=0 width="24" height="24"></a>
<a href="030c.htm" target="UDOcon"><img src="udo_rg.gif" alt="Atari ST Testkit" border=0 width="24" height="24"></a>
</td></tr></table>
<table border=0 cellpadding=0 cellspacing=0 width="100%"><tr>
<td valign=top width="8">&nbsp;</td><td valign=top width="100%">
<h1><a name="MegaST_20Bus">3.11 MegaST Bus</a></h1>
<p align=center><img src="image/sline.gif" border=0 width="640" height="2"></p><br>
<p><tt> Atari MegaST Bus - Pinout </tt>
<br>
<br>
</p>
<p><img src="image/english.gif" border=0 width="35" height="22"></p><br>
<p>Date: 9 May 91 22:26:49 GMT
<br>
<br>
</p>
<p>As there has been some discussion on the Mega ST internal bus of
late the following post briefly details the bus connections and what
each pins function is. Refer to any MC68000 data book for more info.
What is presented has been abreviated slightly but no vital
information was edited out. The whole document runs for about 10
pages, most of it esoteric, dealing with Atari's reasons for the bus
and copyright info plus a lengthy Introduction on the design of the
bus. No real information. Hope this is of help. If you have any
queries please don't hesitate to call me. Best of luck.
<br>
</p>
<p>As to whether this is legal or not - I don't know. If problems do
arise as to the legality please inform me as I don't want to cause any
serious problems. Some parts are copied (ie; typed in by hand, by
myself) verbatim from the original documents.
<br>
<br>
<br><b> Atari Mega ST internal bus / Mechanical Description: </b>
<br>
</p>
<p>Two sizes of expansion card are supported. One, the half card is
half the depth of the Mega St unit. The other, the full card is the
full depth of the unit. In either case, the card butts up to the rear
panel of the St unit which has been provided with a removeable hatch
through which connectors and/or cables can be mounted.
<br>
<br>
</p>
<p>The expansion card connects to the St motherboard through a 64 pin
connector mounted on the bottom (solder) side of the expansion board.
This connector plugs directly into its mate mounted on the
motherboard. Standoffs, 25mm in length, are mounted into the bottom
case through the motherboard. the expansion card is then screwed down
to the standoffs. The standoffs and screws are not supplied with the
Mega St and thus should be included with the expansion card. A hole
located in the left rear of the expansion card fits around a plastic
stud to provide extra strain relief for rear mounting connectors (See
diagrams).
<br>
<br>
</p>
<p><b> Electrical Description: </b>
<br>
</p>
<p>The signals provided on the 64 pin connector are essentially the
pins of the 68000 processor. These signals are all unbuffered. They
are intended to drive one LS TTL load on the expansion board. driving
more than one load or driving excessive capacitance may cause imporper
St operation. For this reason it is not acceptable to connect to the
expansion connector in any manner other than the one outlined in the
previous section (e.g. connecting directly with a cable is not
acceptable.
<br>
</p>
<p>The bus may be arbitrated away from the processor using the normal
68000 protocol. However, the bus grant signal provided on the
connector is the end of the daisy chain. Response time will be
effected by the DMA going on in the system (e.g. disk activity,
hardware bit-blt transfers, etc). If the peripheral requires DMA to
occur while interrupts are enabled, care must be taken to limit the
transfers to bursts of less than about 50 bus cycles allowing adequate
time between bursts to process the interupts.
<br>
</p>
<p>The timing of the bus is that of any 8Mhz 68k processor. Since the
signals provided are essentially the processor pins, connecting
peripherals in the same manner as you would to any 8Mhz 68k should
work with no problem. DMA is the exception. The bus cycle produced
even while the bus is arbitrated away from the processor must look
exactly like an 8Mhz 68k bus cycle. This constraint is necessary to
provide the proper sharing of the memory between the processor and the
video. In all transfers, DTACK must be provided/sample das required by
the 68k processor specification. Also, transfers may not last more
than 64 clock cycles. The St will automatically generate a bus error
if AS is held low for more than 64 clock cycles.
<br>
</p>
<p>The following diagram shows a top view of the connector on the
motherboard with its associated pin numbers and signal names. This
connector (TRW no. 009-00002-8, JAE no. ME03-R64P-D4T2-A1 or
equivalent) is the male side. The expansion board uses the female side
(TRW no. 009-00005-6, JAE no. ME03-64S-D4R1-A1 or equivalent).
<br>
</p>
<p>
<br>
<br>
</p>
<p align=center><img src="image/megast1.gif" border=0 width="640" height="657"></p><br>
<div align=center><tt> Abbildung 1 - Atari Maga ST </tt>
<br>
</div>
<p>
<br>
<br>
</p>
<p>
<br>
</p>
<p>
<br>
</p>
<div align=center><table border=1 frame=box>
<caption align=bottom>Tabelle 10: Top view of motherboard connector</caption>
<tr>
  <td align=left valign=top>Bus Signal</td>
  <td align=left valign=top>Pin</td>
  <td align=left valign=top></td>
  <td align=left valign=top>Pin</td>
  <td align=left valign=top>Bus Signal</td>
</tr>
<tr>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
</tr>
<tr>
  <td align=left valign=top>d4</td>
  <td align=left valign=top>(1)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(2)</td>
  <td align=left valign=top>d5</td>
</tr>
<tr>
  <td align=left valign=top>d3</td>
  <td align=left valign=top>(3)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(4)</td>
  <td align=left valign=top>d6</td>
</tr>
<tr>
  <td align=left valign=top>d2</td>
  <td align=left valign=top>(5)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(6)</td>
  <td align=left valign=top>d7</td>
</tr>
<tr>
  <td align=left valign=top>d1</td>
  <td align=left valign=top>(7)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(8)</td>
  <td align=left valign=top>d8</td>
</tr>
<tr>
  <td align=left valign=top>d0</td>
  <td align=left valign=top>(9)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(10)</td>
  <td align=left valign=top>d9</td>
</tr>
<tr>
  <td align=left valign=top>/AS</td>
  <td align=left valign=top>(11)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(12)</td>
  <td align=left valign=top>d10</td>
</tr>
<tr>
  <td align=left valign=top>/UDS</td>
  <td align=left valign=top>(13)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(14)</td>
  <td align=left valign=top>d11</td>
</tr>
<tr>
  <td align=left valign=top>/LDS</td>
  <td align=left valign=top>(15)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(16)</td>
  <td align=left valign=top>d12</td>
</tr>
<tr>
  <td align=left valign=top>R//W</td>
  <td align=left valign=top>(17)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(18)</td>
  <td align=left valign=top>d13</td>
</tr>
<tr>
  <td align=left valign=top>/DTACK</td>
  <td align=left valign=top>(19)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(20)</td>
  <td align=left valign=top>d14</td>
</tr>
<tr>
  <td align=left valign=top>/BG</td>
  <td align=left valign=top>(21)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(22)</td>
  <td align=left valign=top>d15</td>
</tr>
<tr>
  <td align=left valign=top>/BGACK</td>
  <td align=left valign=top>(23)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(24)</td>
  <td align=left valign=top>GND</td>
</tr>
<tr>
  <td align=left valign=top>/BR</td>
  <td align=left valign=top>(25)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(26)</td>
  <td align=left valign=top>a23</td>
</tr>
<tr>
  <td align=left valign=top>GND</td>
  <td align=left valign=top>(27)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(28)</td>
  <td align=left valign=top>a22</td>
</tr>
<tr>
  <td align=left valign=top>CLK</td>
  <td align=left valign=top>(29)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(30)</td>
  <td align=left valign=top>a21</td>
</tr>
<tr>
  <td align=left valign=top>GND</td>
  <td align=left valign=top>(31)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(32)</td>
  <td align=left valign=top>GND</td>
</tr>
<tr>
  <td align=left valign=top>/HALT</td>
  <td align=left valign=top>(33)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(34)</td>
  <td align=left valign=top>a20</td>
</tr>
<tr>
  <td align=left valign=top>/RESET</td>
  <td align=left valign=top>(35)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(36)</td>
  <td align=left valign=top>a19</td>
</tr>
<tr>
  <td align=left valign=top>/VMA</td>
  <td align=left valign=top>(37)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(38)</td>
  <td align=left valign=top>a18</td>
</tr>
<tr>
  <td align=left valign=top>E</td>
  <td align=left valign=top>(39)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(40)</td>
  <td align=left valign=top>a17</td>
</tr>
<tr>
  <td align=left valign=top>/VPA</td>
  <td align=left valign=top>(41)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(42)</td>
  <td align=left valign=top>a16</td>
</tr>
<tr>
  <td align=left valign=top>/BERR</td>
  <td align=left valign=top>(43)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(44)</td>
  <td align=left valign=top>a15</td>
</tr>
<tr>
  <td align=left valign=top>/NMI</td>
  <td align=left valign=top>(45)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(46)</td>
  <td align=left valign=top>a14</td>
</tr>
<tr>
  <td align=left valign=top>/INT-5</td>
  <td align=left valign=top>(47)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(48)</td>
  <td align=left valign=top>a13</td>
</tr>
<tr>
  <td align=left valign=top>/INT-3</td>
  <td align=left valign=top>(49)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(50)</td>
  <td align=left valign=top>a12</td>
</tr>
<tr>
  <td align=left valign=top>FC2</td>
  <td align=left valign=top>(51)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(52)</td>
  <td align=left valign=top>a11</td>
</tr>
<tr>
  <td align=left valign=top>FC1</td>
  <td align=left valign=top>(53)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(54)</td>
  <td align=left valign=top>a10</td>
</tr>
<tr>
  <td align=left valign=top>FC0</td>
  <td align=left valign=top>(55)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(56)</td>
  <td align=left valign=top>a9</td>
</tr>
<tr>
  <td align=left valign=top>a1</td>
  <td align=left valign=top>(57)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(58)</td>
  <td align=left valign=top>a8</td>
</tr>
<tr>
  <td align=left valign=top>a2</td>
  <td align=left valign=top>(59)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(60)</td>
  <td align=left valign=top>a7</td>
</tr>
<tr>
  <td align=left valign=top>a3</td>
  <td align=left valign=top>(61)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(62)</td>
  <td align=left valign=top>a6</td>
</tr>
<tr>
  <td align=left valign=top>a4</td>
  <td align=left valign=top>(63)</td>
  <td align=left valign=top></td>
  <td align=left valign=top>(64)</td>
  <td align=left valign=top>a5</td>
</tr>
<tr>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
</tr>
<tr>
  <td align=left valign=top>front of ST</td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
  <td align=left valign=top>rear of ST</td>
</tr>
</table></div>

<p>
<br>
</p>
<p>The following is a brief description of each signal on the
connector. For more detailed info consult a 68000 processor manual.
<br>
</p>
<dl>
<dt><b> CLK</b></dt><dd>
<br>&nbsp;
<br>This signal is an 8.0106Mhz TTL compatible, 50% duty cycle square
wave.
<br>&nbsp;
<dt><b>/RESET, /HALT</b></dt><dd>
<br>&nbsp;
<br>In combination these two signals can be used to indicate a system
reset. The /RESET can be used by itself to indicate a system or s/w
reset (RESET instruction executed). These are both bidirectional (open
collector) signal terminated on the motherboard with a 1K and a 4K7
pullup respectively. They may be driven according to standard 68000
processor timing to acheive the functions of the 68000's /RESET and
/HALT lines.
<br>&nbsp;
<br>A system reset will occur at powerup and any time the reset switch
is pressed. It causes both lines to go low for at least 1ms. A
software reset will cause only the /RESET line to go low for
approximately 15us.
<br>&nbsp;
<dt><b>A1-A23</b></dt><dd>
<br>&nbsp;
<br>These lines provide the 23-bit address directly from the 68000
processor. Terminated with 4K7 pullups on the motherboard.
<br>&nbsp;
<dt><b>D0-D15</b></dt><dd>
<br>&nbsp;
<br>16 bit bidirectional data bus. Terminated with 10K pullups on the
motherboard.
<br>&nbsp;
<dt><b>FC0, FC1, FC2</b></dt><dd>
<br>&nbsp;
<br>These lines indicate the processor status for the current bus
cycle. They are directly driven by the 68000 processor. Terminated by
10K pullups on the motherboard.
<br>&nbsp;
<dt><b>/AS</b></dt><dd>
<br>&nbsp;
<br>When low, indicates valid address on address bus. Terminated with
4K7 pullups on motherboard.
<br>&nbsp;
<dt><b>R//W</b></dt><dd>
<br>&nbsp;
<br>When high, processor is doing a read. When low, processor is doing
A write. Terminated with 4K7 pullups on motherboard.
<br>&nbsp;
<dt><b>/UDS, /LDS</b></dt><dd>
<br>&nbsp;
<br>/UDS indicates upper 8 bits, ie; D8-D15. /LDS indicates lower 8
bits, ie; D0-D7. Terminated with 4K7 pullups on motherboard.
<br>&nbsp;
<dt><b>/DTACK</b></dt><dd>
<br>&nbsp;
<br>Bidirectional signal used to indicate a completed data transfer.
Terminated on motherboard with a 1K pullup
<br>&nbsp;
<dt><b>/BERR</b></dt><dd>
<br>&nbsp;
<br>Used to tell the processor or DMA device that no peripheral device
has reponded to the current bus cycle. The ST will automatically
generate this signal if a bus cycle does not complete within 64 clock
cycles. Terminated on motherboard with 4K7 pullup.
<br>&nbsp;
<dt><b> E </b></dt><dd>
<br>&nbsp;
<br>Enable clock used for 6800 peripherals. 60/40 duty cycle.
<br>&nbsp;
<dt><b>/VPA</b></dt><dd>
<br>&nbsp;
<br>Open collector line used to indicate that a 6800 type cycle should
be executed. Terminated by 4K7 pullup.
<br>&nbsp;
<dt><b>/VMA</b></dt><dd>
<br>&nbsp;
<br>This signal is used to synchronise 6800 type bus transfers with
the E clock.
<br>&nbsp;
<dt><b>/BR</b></dt><dd>
<br>&nbsp;
<br>Indicates that the bus will be released at the end of the current
bus cycle. This signal is daisy chained through the other DMA devices
on the motherboard, it does not come directly from the processor.
<br>&nbsp;
<dt><b>/BGACK</b></dt><dd>
<br>&nbsp;
<br>Open collector signal used by a DMA device to claim bus
mastership. Terminated by 4K7 pullup on motherboard. Should also be
terminated on expansion board with another 4K7 pullup.
<br>&nbsp;
<dt><b>/NMI, /INT-5, /INT-3</b></dt><dd>
<br>&nbsp;
<br>These signals are used to asynchronously generate a level 7, level
5 or level 3 interrupt. These are the only levels which can be
generated externally. If they all occur simultaneously, the highest
priority (level 7) will be acknowledged first. The expansion card is
responsi#ble for responding to any interrupt acknowledges for
interrupts which it generates. These acknowledges can be either
vectored or auto-vectored. All three lines are terminated by a 1K
pullup on the motherboard.
<br>&nbsp;
</dl>
<p>
<br>
<br>
</p>
<p><b> Power: </b>
<br>
</p>
<p>Power is supplied to the expansion card through a pigtail cable
which plugs onto a six pin connector on the motherboard. The connector
on the mother- board is AMP no. 171825-6. The mating connector on the
pigtail from the expansion borad is AMP no. 171822-6. The drive
capabilities are as follows;
<br>
</p>
<pre>                        PIN 1 - +5VDC @ 750mA
                        PIN 2 - +5VDC
                        PIN 3 - GND
                        PIN 4 - GND
                        PIN 5 - GND
                        PIN 6 - +12VDC @ 500mA
</pre>
<p>
<br>
<br>
</p>
<p><b> Software Considerations: </b>
<br>
</p>
<p>The mediation of available addresses should not be necessary since
only one expansion card may be plugged in at any one time. Atari has
set aside the addresses C00000 through CFFFFF, FF0000 through FF7FFF
and FFFE00 through FFFFFD for use by outside developers. Spurious
accesses to FFFFFE/FFFFFF may be generated.
<br>
</p>
<p>You can't add RAM which will work as video memory and/or will
allow DMA. Also if memory is extended on the expansion card, the
operating system will not clear it or allow it to be allocated.
<br>
<br>
</p>
<p>
<br>Does anyone know what the pinout of the Mega ST Internal connector
is in relation to the external DMA connector?
<br>
</p>
<p>I have written this down some time ago:
<br>
</p>
<p>
<br>
</p>
<div align=center><table border=1 frame=box>
<tr>
  <td align=left valign=top>D19</td>
  <td align=left valign=top>B24</td>
</tr>
<tr>
  <td align=left valign=top></td>
  <td align=left valign=top></td>
</tr>
<tr>
  <td align=left valign=top>1</td>
  <td align=left valign=top>2</td>
</tr>
<tr>
  <td align=left valign=top>2</td>
  <td align=left valign=top>4</td>
</tr>
<tr>
  <td align=left valign=top>3</td>
  <td align=left valign=top>6</td>
</tr>
<tr>
  <td align=left valign=top>4</td>
  <td align=left valign=top>8</td>
</tr>
<tr>
  <td align=left valign=top>5</td>
  <td align=left valign=top>10</td>
</tr>
<tr>
  <td align=left valign=top>6</td>
  <td align=left valign=top>12</td>
</tr>
<tr>
  <td align=left valign=top>7</td>
  <td align=left valign=top>14</td>
</tr>
<tr>
  <td align=left valign=top>8</td>
  <td align=left valign=top>16</td>
</tr>
<tr>
  <td align=left valign=top>9</td>
  <td align=left valign=top>18</td>
</tr>
<tr>
  <td align=left valign=top>10</td>
  <td align=left valign=top>24</td>
</tr>
<tr>
  <td align=left valign=top>11</td>
  <td align=left valign=top>1          (GND)</td>
</tr>
<tr>
  <td align=left valign=top>12</td>
  <td align=left valign=top>3</td>
</tr>
<tr>
  <td align=left valign=top>13</td>
  <td align=left valign=top>5,7        (GND)</td>
</tr>
<tr>
  <td align=left valign=top>14</td>
  <td align=left valign=top>11</td>
</tr>
<tr>
  <td align=left valign=top>15</td>
  <td align=left valign=top>9,13,15,17 (GND)</td>
</tr>
<tr>
  <td align=left valign=top>16</td>
  <td align=left valign=top>19</td>
</tr>
<tr>
  <td align=left valign=top>17</td>
  <td align=left valign=top>20,21       (GND)</td>
</tr>
<tr>
  <td align=left valign=top>18</td>
  <td align=left valign=top>22</td>
</tr>
<tr>
  <td align=left valign=top>19</td>
  <td align=left valign=top>23</td>
</tr>
</table></div>

<p>
<br>
</p>
<p>It would be a good idea to check connections with an Ohmmeter
anyway. N.B on the internal connector one 12-pin row contains all
odd-numbered pins, and the other row all even-numbered ones.
<br>
</p>
<p>
<br>
<br>
</p>
<p align=center><img src="image/sline.gif" border=0 width="640" height="2"></p><br>
<p align=center><img src="image/img.gif" border=0 width="50" height="40"></p><br>

<hr>
<address>Copyright &copy; <a href="http://www.doitarchive.de/">Robert Schaffner</a> (<a href="mailto:doit@doitarchive.de">doit@doitarchive.de</a>)<br>
Letzte Aktualisierung am 23. Mai 2004</address>
</td></tr></table>
<table border=0 cellpadding=0 cellspacing=0 width="100%"><tr><td valign=top>
<a href="00con.htm" target="UDOcon"><img src="udo_hm.gif" alt="Home" border=0 width="24" height="24"></a>
<a href="03.htm" target="UDOcon"><img src="udo_up.gif" alt="Atari ST Series Hardware" border=0 width="24" height="24"></a>
<a href="030a.htm" target="UDOcon"><img src="udo_lf.gif" alt="Spezifikation Mega STe" border=0 width="24" height="24"></a>
<a href="030c.htm" target="UDOcon"><img src="udo_rg.gif" alt="Atari ST Testkit" border=0 width="24" height="24"></a>
</td></tr></table>
</body></html>
